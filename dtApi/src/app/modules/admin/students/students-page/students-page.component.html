<section class="students">
    <div class="container">
        <div class="students__header">
            <h1>
                <mat-icon class="header-icon">how_to_reg</mat-icon>
                Студенти {{ groupName ? 'групи ' + groupName : '' }}
            </h1>
            <button mat-flat-button color="primary" (click)="add()">
                <mat-icon class="btn-icon">add_circle</mat-icon>
                Додати студента
            </button>
        </div>
        <div class="students__table" *ngIf="!loading; else loader">
            <div
                class="table-wrapper"
                *ngIf="dataSource.data.length > 0; else empty"
            >
                <mat-form-field>
                    <mat-label>
                        <mat-icon class="search-icon">person_search</mat-icon>
                        Фільтр
                    </mat-label>
                    <input
                        matInput
                        (keyup)="applyFilter($event)"
                        placeholder="Здійснюйте фільтрацію по всіх колонках таблиці"
                        #input
                    />
                </mat-form-field>

                <table
                    mat-table
                    [dataSource]="dataSource"
                    class="mat-elevation-z8"
                >
                    <ng-container matColumnDef="index">
                        <th mat-header-cell *matHeaderCellDef>№</th>
                        <td mat-cell *matCellDef="let student; let idx = index">
                            {{ idx + 1 }}
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="gradebookID">
                        <th mat-header-cell *matHeaderCellDef>
                            Номер залікової книжки
                        </th>
                        <td mat-cell *matCellDef="let student">
                            {{ student.gradebook_id }}
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="studentInfo">
                        <th mat-header-cell *matHeaderCellDef>ПІБ</th>
                        <td mat-cell *matCellDef="let student">
                            {{ student.student_surname }}
                            {{ student.student_name }}
                            {{ student.student_fname }}
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="actions">
                        <th
                            mat-header-cell
                            *matHeaderCellDef
                            [ngStyle]="{ 'padding-left': '13px' }"
                        >
                            Дії
                        </th>
                        <td mat-cell *matCellDef="let student">
                            <button
                                class="action-button"
                                mat-flat-button
                                color="primary"
                                (click)="view(student)"
                                matTooltip="Переглянути дані студента"
                            >
                                <mat-icon>assignment_ind</mat-icon>
                            </button>
                            <button
                                class="action-button"
                                mat-flat-button
                                color="primary"
                                matTooltip="Редагувати дані студента"
                                (click)="edit(student)"
                            >
                                <mat-icon>edit</mat-icon>
                            </button>
                            <button
                                class="action-button"
                                mat-flat-button
                                color="primary"
                                matTooltip="Перевести студента до іншої групи"
                                (click)="transfer(student)"
                            >
                                <mat-icon>compare_arrows</mat-icon>
                            </button>
                            <button
                                class="action-button"
                                mat-flat-button
                                color="primary"
                                matTooltip="Видалити студента"
                                (click)="
                                    remove(
                                        student.student_name,
                                        student.student_surname,
                                        student.user_id
                                    )
                                "
                            >
                                <mat-icon>delete</mat-icon>
                            </button>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr
                        mat-row
                        *matRowDef="let row; columns: displayedColumns"
                    ></tr>

                    <tr class="mat-row" *matNoDataRow>
                        <td class="mat-cell" colspan="4">
                            Нічого не знайдено за заданим фільтром "{{
                                input.value
                            }}"
                        </td>
                    </tr>
                </table>
            </div>

            <ng-template #empty>
                <div class="empty-data">
                    <h1>Студенти відсутні</h1>
                </div>
            </ng-template>
        </div>
        <ng-template #loader>
            <app-loader></app-loader>
        </ng-template>
        <mat-paginator
            [class.hide]="loading || !dataSource.data.length"
            [pageSizeOptions]="[5, 10, 20, 25, 30]"
            showFirstLastButtons
        ></mat-paginator>
    </div>
</section>
